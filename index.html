<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home Revival Brisbane</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <!-- Top strip for phone and socials -->
    <div class="top-strip">
      <div class="call-banner">
        Prefer to talk? <a href="tel:0408540150" class="call-link">Call us on <strong>0408 540 150</strong></a>
      </div>

      <div class="top-right">
        <!-- Social links placeholder -->
      </div>
    </div>
    <div class="header-main">
      <div class="site-name">
        <a href="index.html" style="text-decoration: none; color: inherit;">Home Revival Brisbane</a>
      </div>
      <div class="header-right">
        <div class="dropdown">
          <button class="dropbtn">‚ò∞ Menu</button>
          <div class="dropdown-content">
            <a href="about.html">About Us</a>
            <a href="contact.html">Contact us</a>
            <a href="terms.html">Terms & Conditions</a>
            <a href="privacy.html">Privacy Policy</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <section id="hero">
    <h2>Need something fixed or sorted at home?</h2>
    <p>We connect you to the right local professional ‚Äî fast, simple, and hassle-free.</p>
  </section>

  <!-- Service Icons -->
  <div class="service-container">
    <div class="service" onclick="openForm('Plumbing')">üöø<br />Plumbing</div>
    <div class="service" onclick="openForm('Electrical')">üí°<br />Electrical</div>
    <div class="service" onclick="openForm('Painting')">üé®<br />Painting</div>
    <div class="service" onclick="openForm('Gardening')">üåø<br />Gardening</div>
    <div class="service" onclick="openForm('Cleaning')">üßπ<br />Cleaning</div>
    <div class="service" onclick="openForm('Appliances')">üõ†Ô∏è<br />Appliances</div>
    <div class="service" onclick="openForm('Carpentry')">üî®<br />Carpentry</div>
    <div class="service" onclick="openForm('Plastering')">üß±<br />Plastering</div>
    <div class="service" onclick="openForm('Furniture')">ü™ë<br />Furniture</div>
    <div class="service" onclick="openForm('Other')">‚ùì<br />Other</div>
  </div>

  <!-- Contact Form Modal -->
  <div class="modal hidden" id="contactForm">
    <div class="modal-content scrollable">
      <span class="close-btn" onclick="closeForm()">&times;</span>
      <h2 id="formTitle">Request Help</h2>
      <p id="feeNote"><strong>Note:</strong> One-time <strong>$30</strong> fee applies. If we can‚Äôt find help, we‚Äôll refund you.</p>

      <form id="serviceRequestForm" action="https://formspree.io/f/xzzvayyq" method="POST">
        <label class="required">Your Name:</label>
        <input type="text" name="name" required />

        <label class="required">Email:</label>
        <input type="email" name="email" required />

        <label class="required">Phone Number:</label>
        <input type="tel" name="phone" required />

        <label class="required">Address:</label>
        <input type="text" name="address" required />

        <div class="date-urgent-row">
          <div class="form-column">
            <label>Preferred completion date:</label>
            <input type="date" name="completionDate" />
          </div>
          <div class="form-column urgent-checkbox">
            <label>
              <input type="checkbox" name="urgent" />
              This is urgent (ASAP)
            </label>
            <p class="urgent-note">Additional $40 urgent fee applies</p>
          </div>
        </div>

        <label class="required">Budget:</label>
        <input type="text" name="budget" />

        <div class="form-group">
          <label class="required" for="additionalInfo">Job Description</label>
          <textarea name="additionalInfo" id="additionalInfo" placeholder="Describe the issue, job requirements, or any important details..." required></textarea>
          <small class="form-info">Please provide all necessary details about the job to help us connect you with the right professional.</small>
        </div>

        <label class="required">
          <input type="checkbox" name="terms" required />
          I agree to the <a href="terms.html" target="_blank">Terms & Conditions</a>
        </label>

        <div id="formErrorMsg" style="color:red; display:none; margin-bottom:10px;"></div>

        <button type="submit">Submit Request</button>
      </form>
    </div>
  </div>

  <!-- Order Summary Modal -->
  <div class="modal hidden" id="orderSummaryModal">
    <div class="modal-content scrollable">
      <span class="close-btn" onclick="cancelOrderSummary()">&times;</span>
      <h2>Confirm Your Request</h2>
      <div id="orderDetails"></div>
      <div style="margin-top: 20px;">
        <button id="confirmPaymentBtn" style="background:#2c5f2d; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer;">Confirm and Proceed</button>
        <button onclick="cancelOrderSummary()" style="margin-left: 10px; padding:10px 20px; border-radius:5px; cursor:pointer;">Cancel</button>
      </div>
      <div id="orderErrorMsg" style="color:red; margin-top: 10px; display:none;"></div>
    </div>
  </div>

  <!-- Terms Modal -->
  <div class="modal hidden" id="termsModal">
    <div class="modal-content scrollable">
      <span class="close-btn" onclick="closeTermsModal()">&times;</span>
      <h3>Terms & Conditions</h3>
      <p>By submitting a request, you agree to our $30 non-refundable fee unless we are unable to find help. Home
        Revival Brisbane acts only as a service connector. We are not responsible for the performance or outcome of
        services provided by third-party professionals.</p>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 Home Revival Brisbane<br /><small>ABN: 76 698 587 269</small><br /><small>Hours: 9am‚Äì5pm, Monday to
        Friday (excl. public holidays)</small></p>
    <a href="terms.html">Terms & Conditions</a><a href="privacy.html">Privacy Policy</a>
  </footer>

  <script>
    // Prices for each service type
    const servicePrices = {
      Plumbing: 50,
      Electrical: 50,
      Painting: 30,
      Gardening: 20,
      Cleaning: 20,
      Appliances: 30,
      Carpentry: 30,
      Plastering: 30,
      Furniture: 30,
      Other: 20
    };

    // --- Modal open/close logic ---
    function openForm(service) {
      // Set form title
      document.getElementById('formTitle').innerText = `Request Help: ${service}`;

      // Set service type in hidden input
      let hidden = document.getElementById('serviceType');
      if (!hidden) {
        hidden = document.createElement('input');
        hidden.type = 'hidden';
        hidden.name = 'serviceType';
        hidden.id = 'serviceType';
        document.getElementById('serviceRequestForm').appendChild(hidden);
      }
      hidden.value = service;

      // Get price for the service
      const price = servicePrices[service] || 30;

      // Update fee note only (no separate price display)
      const feeNoteEl = document.getElementById('feeNote');
      if (service === 'Other') {
        feeNoteEl.innerHTML = `<strong>Note:</strong> One-time <strong>$20</strong> fee applies (subject to change). If we can‚Äôt find help, we‚Äôll refund you.`;
      } else {
        feeNoteEl.innerHTML = `<strong>Note:</strong> One-time <strong>$${price}</strong> fee applies. If we can‚Äôt find help, we‚Äôll refund you.`;
      }

      // Show modal
      document.getElementById('contactForm').classList.remove('hidden');
    }

    function closeForm() {
      document.getElementById('contactForm').classList.add('hidden');
    }

    function openTermsModal() {
      document.getElementById('termsModal').classList.remove('hidden');
    }

    function closeTermsModal() {
      document.getElementById('termsModal').classList.add('hidden');
    }

    // Cancel order summary modal and return to form
    function cancelOrderSummary() {
      document.getElementById('orderSummaryModal').classList.add('hidden');
      document.getElementById('contactForm').classList.remove('hidden');
      document.getElementById('orderErrorMsg').style.display = 'none';
    }

    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("serviceRequestForm");

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const errorMsg = document.getElementById("formErrorMsg");
        errorMsg.style.display = "none";

        // Validate required fields
        let errorFields = [];
        let requiredFields = form.querySelectorAll("[required]");
        requiredFields.forEach((field) => {
          if (
            (field.type === "checkbox" && !field.checked) ||
            (field.type !== "checkbox" && !field.value.trim())
          ) {
            errorFields.push(field);
            field.classList.add("error-field");
          } else {
            field.classList.remove("error-field");
          }
        });

        if (errorFields.length > 0) {
          errorMsg.textContent =
            "Please fill in all required fields and accept the Terms & Conditions.";
          errorMsg.style.display = "block";
          return; // stop submission if invalid
        }

        // Validation passed, show order summary modal

        // Gather form data
        const formData = new FormData(form);
        const data = {};
        formData.forEach((value, key) => {
          data[key] = value;
        });

        // Calculate prices
        const service = data.serviceType;
        const basePrice = servicePrices[service] || 30;
        const urgentFee = form.querySelector('input[name="urgent"]').checked ? 40 : 0;
        const totalPrice = basePrice + urgentFee;

        // Build order summary HTML
        let summaryHTML = `
          <p><strong>Service:</strong> ${service}</p>
          <p><strong>Name:</strong> ${data.name}</p>
          <p><strong>Email:</strong> ${data.email}</p>
          <p><strong>Phone:</strong> ${data.phone}</p>
          <p><strong>Address:</strong> ${data.address}</p>
          <p><strong>Preferred Completion Date:</strong> ${data.completionDate || 'Not specified'}</p>
          <p><strong>Urgent:</strong> ${urgentFee ? 'Yes (+$40)' : 'No'}</p>
          <p><strong>Budget:</strong> ${data.budget || 'Not specified'}</p>
          <p><strong>Job Description:</strong> ${data.additionalInfo}</p>
          <hr />
          <p><strong>Cost Breakdown:</strong></p>
          <p>Base Service Fee: $${basePrice}</p>
          <p>Urgent Fee: $${urgentFee}</p>
          <p><strong>Total Cost: $${totalPrice}</strong></p>
        `;

        document.getElementById('orderDetails').innerHTML = summaryHTML;

        // Hide main form modal, show order summary modal
        closeForm();
        document.getElementById('orderSummaryModal').classList.remove('hidden');

        // Store formData for submission on confirmation
        window.confirmationFormData = formData;
      });

      // Confirm & proceed button listener
      document.getElementById('confirmPaymentBtn').addEventListener('click', async function () {
        const orderErrorMsg = document.getElementById('orderErrorMsg');
        orderErrorMsg.style.display = 'none';

        // Submit the stored form data via fetch
        try {
          const response = await fetch(form.action, {
            method: form.method,
            body: window.confirmationFormData,
            headers: {
              'Accept': 'application/json'
            },
          });

          if (response.ok) {
            alert("Thank you! Your request has been sent.");
            form.reset();
            document.getElementById('orderSummaryModal').classList.add('hidden');
          } else {
            const data = await response.json();
            if (data && data.errors) {
              orderErrorMsg.textContent = data.errors.map(e => e.message).join(", ");
            } else {
              orderErrorMsg.textContent = "Oops! There was a problem submitting your form.";
            }
            orderErrorMsg.style.display = "block";
          }
        } catch (error) {
          orderErrorMsg.textContent = "Network error. Please try again later.";
          orderErrorMsg.style.display = "block";
        }
      });
    });
  </script>
</body>

</html>
